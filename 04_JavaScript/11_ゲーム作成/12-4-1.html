<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>12-4-1</title>
		<style>
			* {margin:0; padding:0;}
			p{text-align:center;}
			#canvas1{border:1px solid gray;}
		</style>
	</head>
	<body>
		<p><canvas id="canvas1" width="320" height="480"></canvas></p>
		
		<script>
			const canvas1 = document.getElementById("canvas1");
			const ctx1 = canvas1.getContext("2d");

			//①変数の設定と初期化
			const target = {x:250, y:100, dir:1}; // ターゲットのxy位置と移動方向
			const player = {x:250, y:400}; // プレーヤのxy位置
			const ball = {x:-10, y:-10}; // ボールのxy位置
			let point = 0; // 得点

			const targetImage = new Image();
			const playerImage = new Image();
			const ballImage = new Image();

			targetImage.src="target.png";
			playerImage.src="player.png";
			ballImage.src="ball.png";

			const audio1 = new Audio();		//音声ファイル
			audio1.src="audio1.mp3";

			//②一定時間毎にプログラムgame1を起動させる
			setInterval(game1,50);

			//③game1関数
			function game1(){
				ctx1.clearRect(0,0,320,480);

				//描画(ターゲット)
				ctx1.drawImage(targetImage, target.x-25, target.y-5, 50, 50);
				// ctx1.fillStyle = "black";
				// ctx1.fillRect(target.x-25,target.y-5,50,10);

				//描画(得点)
				ctx1.fillStyle = "black";
				ctx1.font = "20px sans-serif";
				ctx1.fillText(point,target.x,target.y-5);

				//描画(プレーヤ)
				ctx1.drawImage(playerImage, player.x-25, player.y-5, 50, 50);
				// ctx1.fillStyle = "blue";
				// ctx1.fillRect(player.x-25,player.y-5,50,10);

				//描画(ボール)
				ctx1.drawImage(ballImage, ball.x-25, ball.y-5, 10, 10);
				// ctx1.fillStyle = "red";
				// ctx1.beginPath();
				// ctx1.arc(ball.x,ball.y,5,0,2*Math.PI,false);
				// ctx1.closePath();
				// ctx1.fill();

				//移動計算
				target.x += target.dir;
				ball.y -= 5;

				if(target.x < 25 || 295 < target.x){target.dir *= -1;}

				//得点計算
				if ((ball.y === 100) && (Math.abs(target.x - ball.x)<25)){
					point++;
					audio1.play();
				}
			}

			//④シュート関数
			canvas1.addEventListener("mousedown",function(){
				ball.x = player.x;
				ball.y = player.y; 
			});

			//⑤プレーヤコントロール
			canvas1.addEventListener("mousemove",function(e){
				const rect = e.target.getBoundingClientRect();
				player.x = e.clientX-rect.left;
			});
		</script>
	</body>
</html>